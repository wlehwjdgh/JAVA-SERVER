<!doctype html>
<html>
<head>
  <title>Line Chart</title>	
  <script src="node_modules/chart.js/dist/Chart.min.js"></script>
  <script src="node_modules/utils.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</head>


<body>
	<p>result : <span id="result"></span></p>
	<button id="refreshData">Refresh</button>
	
	<div style="width:50%;">
    <canvas id="myChartX"></canvas>
    <br>
    <br>
		<canvas id="myChartY"></canvas>
    <br>
    <br>
		<canvas id="myChartZ"></canvas>
  </div>
  
<script>
  const numOfChart  = 3;
  const numOfData = 32;
  const idxX = 0;
  const idxY = 1;
  const idxZ = 2;

  var labelsData = new Array();
  var canvasId = new Array(numOfChart);
  var ctx = new Array(numOfChart);
  var frqData = new Array(numOfChart);
  var config = new Array(numOfChart);
  var myChart = new Array(numOfChart);
  var chartColor = new Array(numOfChart);
  var chartLabel = new Array(numOfChart);
  var obj;
  
  frqData[idxX] = new Array();
  frqData[idxY] = new Array();
  frqData[idxZ] = new Array();

  canvasId[idxX] = "myChartX";
  canvasId[idxY] = "myChartY";
  canvasId[idxZ] = "myChartZ";

  chartColor[idxX] = "#ff6384";
  chartColor[idxY] = "#cc65fe";
  chartColor[idxZ] = "#ffce56";

  chartLabel[idxX] = "X";
  chartLabel[idxY] = "Y";
  chartLabel[idxZ] = "Z";

  for(var i=0;i<numOfData;i++){
    labelsData.push(i)
  }
  
  for(var i=0;i<numOfChart;i++){
    ctx[i] = document.getElementById( canvasId[i] );
    config[i] = {
      type: 'line',
      data: {
        labels: labelsData,
        datasets: [{
          label: chartLabel[i] +' Axis Frequency',
          data: frqData[i],
          backgroundColor: chartColor[i]
        }]
      },
      options: {
        responsive: true,
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero:true
            }
          }]
        }
      }
    }
    myChart[i] = new Chart(ctx[i],config[i]);
  }
  window.onload = function() {
    randomScalingFactor();
    setInterval("randomScalingFactor()",2000);
  };

  var randomScalingFactor = function(){ 
	
    for(var i=1;i<numOfChart;i++){
    //for(var i=0;i<numOfChart;i++){
      for(var j=0;j<numOfData;j++){
        frqData[i][j] = (Math.round(Math.random()*100));
      }
      window.myChart[i].update()
    }
  }
  
  $('#refreshData').click(function(){
	  $.ajax({
		  url:'http://localhost:8091/frqTest/Hello',
		  type:'post',
		  data:'test-browser',
		  success:function(res){
			  $('#result').text(res);
			  console.log(res);
			  var obj = JSON.parse(res);
			 // var obj = JSON.parse('{"axis":0,"data":[32768,45307,55938,63041,65535,63041,55938,45307,32768,20228,9597,2494,0,2494,9597,20228,32768,45307,55938,63041,65535,63041,55938,45307,32768,20228,9597,2494,0,2494,9597,20228],"length":32}');
			  console.log(obj);
		  }
	  })
  })
</script>

</body>
</html>